

* Encoding: UTF-8.
*dataset1: checking frequencies of all variables to be used

FREQUENCIES VARIABLES=pain age weight sex STAI_trait pain_cat cortisol_serum 
    cortisol_saliva mindfulness
  /NTILES=4
  /STATISTICS=STDDEV RANGE MINIMUM MAXIMUM MEAN MEDIAN MODE SUM SKEWNESS SESKEW KURTOSIS SEKURT
  /HISTOGRAM NORMAL
  /ORDER=ANALYSIS.

*everything seems fine

RECODE sex ('male'=0) ('female'=1) (MISSING=SYSMIS) INTO sex_female.
EXECUTE.


*run a regression for the initial backward model to save the residuals

REGRESSION
  /MISSING LISTWISE
  /STATISTICS COEFF OUTS CI(95) BCOV R ANOVA COLLIN TOL SELECTION
  /CRITERIA=PIN(.05) POUT(.10)
  /NOORIGIN 
  /DEPENDENT pain
  /METHOD=ENTER age sex_female weight STAI_trait pain_cat cortisol_serum mindfulness
  /SCATTERPLOT=(*ZRESID ,*ZPRED)
  /RESIDUALS NORMPROB(ZRESID)
  /SAVE PRED COOK RESID.

*cook distance check

* Chart Builder.
GGRAPH
  /GRAPHDATASET NAME="graphdataset" VARIABLES=ID COO_1 MISSING=LISTWISE REPORTMISSING=NO
  /GRAPHSPEC SOURCE=INLINE
  /FITLINE TOTAL=NO.
BEGIN GPL
  SOURCE: s=userSource(id("graphdataset"))
  DATA: ID=col(source(s), name("ID"), unit.category())
  DATA: COO_1=col(source(s), name("COO_1"))
  GUIDE: axis(dim(1), label("ID"))
  GUIDE: axis(dim(2), label("Cook's Distance"))
  GUIDE: text.title(label("Simple Scatter of Cook's Distance by ID"))
  SCALE: linear(dim(2), include(0))
  ELEMENT: point(position(ID*COO_1))
END GPL.

*run a model diagnostic with weight variable

*Modeldiagnostic
*1.Normality of residuals for all cases

*1.1 examine


EXAMINE VARIABLES=RES_1
  /PLOT BOXPLOT HISTOGRAM NPPLOT
  /COMPARE GROUPS
  /STATISTICS DESCRIPTIVES
  /CINTERVAL 95
  /MISSING LISTWISE
  /NOTOTAL.
 
*Normality seems fine

*2.Linearity

*2.1 check for the linearity of age and pain

* Chart Builder.
GGRAPH
  /GRAPHDATASET NAME="graphdataset" VARIABLES=age pain MISSING=LISTWISE REPORTMISSING=NO
  /GRAPHSPEC SOURCE=INLINE
  /FITLINE TOTAL=NO.
BEGIN GPL
  SOURCE: s=userSource(id("graphdataset"))
  DATA: age=col(source(s), name("age"))
  DATA: pain=col(source(s), name("pain"))
  GUIDE: axis(dim(1), label("age"))
  GUIDE: axis(dim(2), label("pain"))
  GUIDE: text.title(label("Simple Scatter of pain by age"))
  ELEMENT: point(position(age*pain))
END GPL.
*compute sq_age

COMPUTE age_sq=age*age.
EXECUTE.

*run a regression by adding age_sq

REGRESSION
  /MISSING LISTWISE
  /STATISTICS COEFF OUTS CI(95) R ANOVA COLLIN TOL CHANGE
  /CRITERIA=PIN(.05) POUT(.10)
  /NOORIGIN 
  /DEPENDENT pain
  /METHOD=ENTER age age_sq sex_female STAI_trait pain_cat cortisol_serum weight
    mindfulness
  /SCATTERPLOT=(*ZRESID ,*ZPRED)
  /RESIDUALS NORMPROB(ZRESID).


*2.2 check for the linearity of STAI_trait and pain
* Chart Builder.
GGRAPH
  /GRAPHDATASET NAME="graphdataset" VARIABLES=STAI_trait pain MISSING=LISTWISE REPORTMISSING=NO
  /GRAPHSPEC SOURCE=INLINE
  /FITLINE TOTAL=NO.
BEGIN GPL
  SOURCE: s=userSource(id("graphdataset"))
  DATA: STAI_trait=col(source(s), name("STAI_trait"))
  DATA: pain=col(source(s), name("pain"))
  GUIDE: axis(dim(1), label("STAI_trait"))
  GUIDE: axis(dim(2), label("pain"))
  GUIDE: text.title(label("Simple Scatter of pain by STAI_trait"))
  ELEMENT: point(position(STAI_trait*pain))
END GPL.

*create STAI_trait_sq

COMPUTE STAI_trait_sq=STAI_trait * STAI_trait.
EXECUTE.

*run a regression by adding STAI_trait_sq

REGRESSION
  /MISSING LISTWISE
  /STATISTICS COEFF OUTS CI(95) BCOV R ANOVA COLLIN TOL CHANGE
  /CRITERIA=PIN(.05) POUT(.10)
  /NOORIGIN 
  /DEPENDENT pain
  /METHOD=ENTER age sex_female STAI_trait pain_cat cortisol_serum mindfulness weight
    STAI_trait_sq
  /SCATTERPLOT=(*ZRESID ,*ZPRED)
  /RESIDUALS NORMPROB(ZRESID).


*2.3 check for the linearity of pain_cat and pain
* Chart Builder.
GGRAPH
  /GRAPHDATASET NAME="graphdataset" VARIABLES=pain_cat pain MISSING=LISTWISE REPORTMISSING=NO
  /GRAPHSPEC SOURCE=INLINE
  /FITLINE TOTAL=NO.
BEGIN GPL
  SOURCE: s=userSource(id("graphdataset"))
  DATA: pain_cat=col(source(s), name("pain_cat"))
  DATA: pain=col(source(s), name("pain"))
  GUIDE: axis(dim(1), label("pain_cat"))
  GUIDE: axis(dim(2), label("pain"))
  GUIDE: text.title(label("Simple Scatter of pain by pain_cat"))
  ELEMENT: point(position(pain_cat*pain))
END GPL.

*create pain_cat_sq to be put into the model

COMPUTE Pain_cat_sq=pain_cat*pain_cat.
EXECUTE.

*run a regression by adding pain_cat_sq

REGRESSION
  /MISSING LISTWISE
  /STATISTICS COEFF OUTS CI(95) BCOV R ANOVA COLLIN TOL CHANGE
  /CRITERIA=PIN(.05) POUT(.10)
  /NOORIGIN 
  /DEPENDENT pain
  /METHOD=ENTER age sex_female STAI_trait pain_cat cortisol_serum mindfulness weight
    Pain_cat_sq
  /SCATTERPLOT=(*ZRESID ,*ZPRED)
  /RESIDUALS NORMPROB(ZRESID).


*2.4 check for the linearity of mindfulness and pain
* Chart Builder.
GGRAPH
  /GRAPHDATASET NAME="graphdataset" VARIABLES=mindfulness pain MISSING=LISTWISE REPORTMISSING=NO
  /GRAPHSPEC SOURCE=INLINE
  /FITLINE TOTAL=NO.
BEGIN GPL
  SOURCE: s=userSource(id("graphdataset"))
  DATA: mindfulness=col(source(s), name("mindfulness"))
  DATA: pain=col(source(s), name("pain"))
  GUIDE: axis(dim(1), label("mindfulness"))
  GUIDE: axis(dim(2), label("pain"))
  GUIDE: text.title(label("Simple Scatter of pain by mindfulness"))
  ELEMENT: point(position(mindfulness*pain))
END GPL.

*the mindfulness seems to be a linear relationship and thus does not need to be transform in a higher term

*2.5 check for the linearity of cortisol_serum and pain
* Chart Builder.
GGRAPH
  /GRAPHDATASET NAME="graphdataset" VARIABLES=cortisol_serum pain MISSING=LISTWISE REPORTMISSING=NO
  /GRAPHSPEC SOURCE=INLINE
  /FITLINE TOTAL=NO.
BEGIN GPL
  SOURCE: s=userSource(id("graphdataset"))
  DATA: cortisol_serum=col(source(s), name("cortisol_serum"))
  DATA: pain=col(source(s), name("pain"))
  GUIDE: axis(dim(1), label("cortisol_serum"))
  GUIDE: axis(dim(2), label("pain"))
  GUIDE: text.title(label("Simple Scatter of pain by cortisol_serum"))
  ELEMENT: point(position(cortisol_serum*pain))
END GPL.

*create cortisol_serum_sq

COMPUTE Cortisol_serum_sq=cortisol_serum*cortisol_serum.
EXECUTE.

*run a regression by adding cortisol_serum_sq

REGRESSION
  /MISSING LISTWISE
  /STATISTICS COEFF OUTS CI(95) BCOV R ANOVA COLLIN TOL CHANGE
  /CRITERIA=PIN(.05) POUT(.10)
  /NOORIGIN 
  /DEPENDENT pain
  /METHOD=ENTER age sex_female STAI_trait pain_cat cortisol_serum mindfulness Cortisol_serum_sq weight
  /SCATTERPLOT=(*ZRESID ,*ZPRED)
  /RESIDUALS NORMPROB(ZRESID).


*2.6 check for the linearity of weight and pain
* Chart Builder.
GGRAPH
  /GRAPHDATASET NAME="graphdataset" VARIABLES=weight pain MISSING=LISTWISE REPORTMISSING=NO
  /GRAPHSPEC SOURCE=INLINE
  /FITLINE TOTAL=NO.
BEGIN GPL
  SOURCE: s=userSource(id("graphdataset"))
  DATA: weight=col(source(s), name("weight"))
  DATA: pain=col(source(s), name("pain"))
  GUIDE: axis(dim(1), label("weight"))
  GUIDE: axis(dim(2), label("pain"))
  GUIDE: text.title(label("Simple Scatter of pain by weight"))
  ELEMENT: point(position(weight*pain))
END GPL.


*create weight_sq

COMPUTE weight_sq=weight*weight.
EXECUTE.

*run a regression by adding weight_sq

REGRESSION
  /MISSING LISTWISE
  /STATISTICS COEFF OUTS CI(95) BCOV R ANOVA COLLIN TOL CHANGE
  /CRITERIA=PIN(.05) POUT(.10)
  /NOORIGIN 
  /DEPENDENT pain
  /METHOD=ENTER age sex_female STAI_trait pain_cat cortisol_serum mindfulness weight weight_sq
  /SCATTERPLOT=(*ZRESID ,*ZPRED)
  /RESIDUALS NORMPROB(ZRESID).


*3.Homoscedasticity

COMPUTE RES_sq=RES_1*RES_1.
EXECUTE.

*checking for homoscedasticty with Residuals_sq as DV

REGRESSION
  /MISSING LISTWISE
  /STATISTICS COEFF OUTS CI(95) BCOV R ANOVA COLLIN TOL CHANGE
  /CRITERIA=PIN(.05) POUT(.10)
  /NOORIGIN 
  /DEPENDENT RES_sq
  /METHOD=ENTER age sex_female weight STAI_trait pain_cat cortisol_serum mindfulness 
  /RESIDUALS NORMPROB(ZRESID).


*4.multicollinearity is not a problem

*dataset1 proceed to stepwise (backward) regression

REGRESSION
  /MISSING LISTWISE
  /STATISTICS COEFF OUTS CI(95) BCOV R ANOVA COLLIN TOL CHANGE SELECTION
  /CRITERIA=PIN(.05) POUT(.10)
  /NOORIGIN 
  /DEPENDENT pain
  /METHOD=BACKWARD age sex_female weight STAI_trait pain_cat mindfulness cortisol_serum 
  /SCATTERPLOT=(*ZRESID ,*ZPRED)
  /RESIDUALS NORMPROB(ZRESID).


*dataset1 run a regression using the backward model

REGRESSION
  /MISSING LISTWISE
  /STATISTICS COEFF OUTS CI(95) BCOV R ANOVA COLLIN TOL CHANGE SELECTION
  /CRITERIA=PIN(.05) POUT(.10)
  /NOORIGIN 
  /DEPENDENT pain
  /METHOD=ENTER age sex_female pain_cat mindfulness cortisol_serum
  /SCATTERPLOT=(*ZRESID ,*ZPRED)
  /RESIDUALS NORMPROB(ZRESID).

*dataset1 compare the original model submitted for backward model and the backward model


REGRESSION
  /MISSING LISTWISE
  /STATISTICS COEFF OUTS CI(95) BCOV R ANOVA COLLIN TOL CHANGE SELECTION
  /CRITERIA=PIN(.05) POUT(.10)
  /NOORIGIN 
  /DEPENDENT pain
  /METHOD=ENTER age sex_female weight STAI_trait pain_cat mindfulness cortisol_serum
  /METHOD=REMOVE weight STAI_trait
  /SCATTERPLOT=(*ZRESID ,*ZPRED)
  /RESIDUALS NORMPROB(ZRESID).

*open Dataset2, run frequencies and the analsys will use dataset2 from here on

FREQUENCIES VARIABLES=pain age sex STAI_trait pain_cat cortisol_serum cortisol_saliva mindfulness 
    weight 
  /NTILES=4
  /STATISTICS=STDDEV RANGE MINIMUM MAXIMUM SEMEAN MEAN MEDIAN MODE SUM SKEWNESS SESKEW KURTOSIS 
    SEKURT
  /HISTOGRAM NORMAL
  /ORDER=ANALYSIS.

*recode sex into dummy and compute cortisol mean

RECODE sex ('male'=0) ('female'=1) (MISSING=SYSMIS) INTO sex_female.
EXECUTE.

COMPUTE cortisol=MEAN(cortisol_serum,cortisol_saliva).
EXECUTE.

*dataset2 prediction calculated by the backward model

COMPUTE Pred_backward=4.357-(age*0.065)-(sex_female*0.338)+(pain_cat*0.068)-(mindfulness*0.268)+
    (cortisol_serum*0.426).
EXECUTE.


*dataset2 prediction calculated by the theory model

COMPUTE Pred_theory=3.51-(age*0.058)-(sex_female*0.33)+(STAI_trait*0.002)+(pain_cat*0.069)-(mindfulness*0.233)+(cortisol*0.489).
EXECUTE.


*dataset2 calculate the square of residuals of the backward model

COMPUTE RES_pred_backward=(pain-Pred_backward)*(pain-Pred_backward).
EXECUTE.


*dataset2 calculate the square of residuals of the theory model

COMPUTE RES_pred_theory=(pain-Pred_theory)*(pain-Pred_theory).
EXECUTE.

*dataset2 run the descriptive table of both Sum of Squares to see which one has higher (more errors)

DESCRIPTIVES VARIABLES=RES_pred_backward RES_pred_theory
  /STATISTICS=MEAN SUM STDDEV MIN MAX.

